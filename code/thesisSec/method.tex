% Author: PokMan Ho pok.ho19@imperial.ac.uk
% Script: method.tex
% Desc: MRes thesis methods section
% Input: none
% Output: none
% Arguments: 0
% Date: Jan 2020

\documentclass[../thesis.tex]{subfiles} %% use packages & commands as this main file

\begin{document}
%this is the methodology
%growth rates are related to the light intensity of the measurement location
\subsection{Coexistence Ecosystem Model}

The numeric model was describing two cyanobacteria lineages \Ss\autocite{sawa2017electricity} (or \As)\autocite{joshi2018bacterial} and \Cs\autocite{baque2013boss,nurnberg2018photochemistry} coexisting and competing on a button mushroom,\autocite{joshi2018bacterial} which they were ink-jet printed on.  The initial community was expected to be a single cell layer filling the whole mushroom pileus upper surface with each lineage contributing 1:1 \ps.  The system would then be left flat at sea-level under natural sunlight at different latitudes and longitudes to observe the spatial competition of the two lineages.  Nutrients and water supply were assumed unlimited, stable and all-rounded by using domestic sewage.\autocite{markou2014microalgal}  Electricity generation by this system would be monitored.  Time of reaching dynamic equilibrium and respective population contribution to the community would be recorded.  At the end of model, biomass accumulation will be calculated.

A set of ordinary differential equations (ODEs) were used describing this coexistence ecosystem.  Physics SI units were strictly adopted in calculations.  Cyanobacteria community dynamic equations were:
\begin{equation}\label{eq:main}
    dp/dt = r_p [p] - k_{p1} [p][q]
\end{equation}
\begin{equation}\label{eq:growth}
    r_p = \dfrac{r_p|_{expt}}{P_p|_{expt}}\cdot P_p
\end{equation}
\begin{equation}\label{eq:compete}
    k_{p2} = \dfrac{P_q}{P_p + P_q}\cdot r_p = \dfrac{P_q P_p}{P_p + P_q}\cdot \dfrac{r_p|_{expt}}{P_p|_{expt}}
\end{equation}

Equation \ref{eq:main} was the core equation calculating expected dynamic interactions between the two lineages.  Equation \ref{eq:growth} was describing the growth rate of target lineage.  Equation \ref{eq:compete} was describing the growth hindering factor of target population exerted by the interacting population.  $dp/dt$ was the instantaneous growth rate.  $[p]$ was the \ps\ of target lineage (either \Ss\ or \Cs).  $[q]$ was the \ps\ of the other lineage interacting with the target.  $r_p$ was the growth rate of target population.  This coefficient was calculated by ratio comparison of power ($P_p$ and $P_p|_{expt}$) between prior experiment report of growth rate $r_p|_{expt}$ (using their light source, assuming nutrition conditions identical between literature and this model).  $k_{p1}$ was the resultant death rate from spatial competition between the two cyanobacteria lineages.  This term was a hinder factor for growth rate.  The coefficient was calculated by power ratio gained by the interacting lineage ($P_q$) compared to the target's.  Initial populations were calculated from the mean pileus size of a mature mushroom and typical cell size of a \Ss\ and \Cs\ cells respectively.

The model were validated by using mean hourly, annual and eleven-year cycles.  Hourly means were to validate the daily cycle, annual means were to validate the seasonal cycle and the eleven-year means were to validate the solar cycle.  The data (1947-2019) was requested from Centre of Environmental Data Analysis (CEDA) Archive.\autocite{solarData}

\subsection{Solar Data for Major Cities} %% global solar irradiation amount "glbl_irad_amt", KJ/m^2
Solar data was formatted as csv files (one year per file) in 22 \href{https://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/RO_Table.html#definition}{columns} and huge variable number of rows, one hour per available station a row.  Three columns (column 3, 5, 7 and 9; ``," as separator) were extracted representing ``record date and time" (DateTime), ``Met office quality confirmed" (Mqc), ``solar station identifier" (Ssi) and ``global solar irradiation amount (10$^{3}$J/m$^{2}$)" (Gsia) data respectively.  Only data with Mqc column value ``1" was used as instructed.  DateTime column was the hourly timestamp for modelling. Ssi column was used to map the Gsia data with geo-location for modelling.  Gsia column was the solar irradiation data with UV-near infrared spectrum ($\lambda$ = 10$^{-8}$-2.5$\times10^{-6}$ m, or 10-2500nm).  For every yearly-recorded file, the three columns were extracted and concatenated with previous years in a long-table form as a csv file with headers.  Then only the Mqc value =1 rows were extracted out as the cleaned raw data.

Data for global major cities were collected based on ``2019 Global Power City Index"\autocite{GPCI2019_summary} (GPCI).  It was assumed that power consumption positively correlated with city ranks.  Geo-location and area covered for the top 48 cities listed on p.7 of GPCI was gathered through Google Earth Pro\autocite{gEarth} and Google web (search phrase: ``<city> city area") incognito searches respectively.  This information was the reference spatial frame of the model.

Solar station geo-location was formatted in Keyhole Markup Language (kml) file upon unzipping the downloaded kmz file.  Among all details, only four information sets were extracted and rearranged in csv format: ``solar station identifier" (Ssi, ``src\_id" in data) and the 3D coordinates (``coordinates" in data) latitude (lat), longitude (lon) and altitude (alt).  The data was the linker data set between the city location and the hourly insolation data.

%% Data descriptions
Only cities had solar data records were considered in the model.  The three data described above were put together and only the insolation data with geo-location within considered cities were extracted.  Mean values of hourly insolation per area data for cities with more than one insolation record.  The final solar data was containing 
%%insert_num_here
 rows and 6 columns (``Year", ``Month", ``Day", ``Hour", ``Location", ``Mean solar irradiation amount (10$^{3}$J/m$^{2}$)").  It contained solar irradiation data of UV to infrared spectrum timed from 
%%insert_num_here
 stations globally across year 
%%insert_num_here
 to 
%%insert_num_here
 in 
%%insert_num_here
 cities.  This data was the geo-located energy per unit area (10$^{3}$J/m$^{2}$) time series input for the calculation of actual energy budget for cyanobacteria.

``Reference Air Mass 1.5 Spectra" was downloaded from the US Department of Energy \href{https://www.nrel.gov/grid/solar-resource/spectra-am1.5.html}{website}.  This was the current standard curve for solar panels to calculate expected energy output.  The spectra was incorporated into the energy budget calculation within the model.  Gsia column in the solar data was the area-under-curve of the reference spectra within the UV-infrared range.  Energy budget of each cyanobacteria lineage was a proportion of this ranged area which intersect its reported photosynthesis spectra.  Due to the standard spectra, the model was referenced at sea-level.  The altitude effect was not reflected by the solar spectra but only indirectly addressed through the Gsia values.

\subsection{Calculations}
\subsubsection{Electricity generating ability}

\subsubsection{Carbon sequestering service efficiency}

\end{document}